var ModelBuilder = require('../../loopback-datasource-juggler').ModelBuilder;
var modelBuilder = new ModelBuilder();
// define models
var Post = modelBuilder.define('Post', {
  "title": {
    "type": "string"
  },
  "author": {
    "type": "string"
  },
  "content": {
    "type": "string"
  },
  "created": {
    "type": "date"
  },
  "modified": {
    "type": "date"
  }
});

for (i = 0; i < 10; i++) {
  var data = {
    author: 'Author' + i, title: 'Blog ' + i,
    content: 'Nice content ' + i,
    created: new Date(),
    modified: new Date()
  };

  var tt = process.hrtime();
  var post = new Post();
  post._initProperties(data);
  console.log('1', process.hrtime(tt));
  tt = process.hrtime();
  post = new Post(data);
  console.log('2', process.hrtime(tt));
}
return;

var t1 = 0;
var t2 = 0;

var t3 = 0;
var t4 = 0;
var start = process.hrtime();

var size = 100;
for (var i = 0; i < size; i++) {
  var t5 = process.hrtime();
  var post = new Post({
    title: 'Title',
    content: 'Content',
    published: false
  });
  var diff = process.hrtime(t5);
  t1 += diff[0] * 1e9 + diff[1];
  if (i % 1000 === 0) {
    console.log('create: %d %d', t1, t1 - t2);
    t2 = t1;
  }

  t5 = process.hrtime();

  post.toJSON();

  diff = process.hrtime(t5);
  t3 += diff[0] * 1e9 + diff[1];
  if (i % 1000 === 0) {
    console.log('toJSON: %d %d', t3, t3 - t4);
    t4 = t3;
  }
}

var total = process.hrtime(start);
console.log('Total: %j, Avg: %d ms/1k reqs', total, (total[0] * 1e9 + total[1]) / (size / 1000) / 1e6);
